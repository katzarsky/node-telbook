function render_persons() {	$.get('/persons', function(data) {		var html = '';				html += "<table class='grid'>";		html += "<tr><th>ID</th><th>NAME</th><th>ADDRESS</th><th></th></tr>";				for(var i=0; i<data.persons.length; i++) {			var p = data.persons[i];			html += "<tr>" +				"<td>" + p.ID + "</td>" +				"<td><a href='#' data-id='" + p.ID + "' class='icon user_icon person-telephones'>" +					html_escape(p.NAME + " " + p.FAM) +				"</a></td>"+				"<td>" + html_escape(p.ADDRESS) + "</td>" +				"<td>" +					"<a href='#' data-id='" + p.ID + "' class='icon edit_icon person-edit'>Edit</a> " +					"<a href='#' data-id='" + p.ID + "' class='icon delete_icon person-delete'>Delete</a>" +				"</td>" +			"</tr>";		}				html += "</table>";				$('#persons').html(html);	});}function render_telephones(person_id) {	$.get('/telephones/person/' + person_id, function(data) {		var html = '';		var p = data.person;		var tels = data.telephones;				html += "<p class='icon user_icon'>" + html_escape(p.NAME + " " + p.FAM) + "</p>";		html += "<table class='grid'>";		html += "<tr><th>ID</td><th>NOMER</th><th>TELTYPE</th><th></th></tr>";				for(var i=0; i<tels.length; i++) {			var tel = tels[i];			html += 				"<tr>"+				"<td>" + tel.ID + "</td>" +				"<td>" + html_escape(tel.NOMER) + "</td>" +				"<td>" + tel.TELTYPE + "</td>" +				"<td>" +					"<a href='#' data-id=" + tel.ID + "' class='icon edit_icon telephone-edit'>Edit</a> " +					"<a href='#' data-id=" + tel.ID + "' class='icon delete_icon telephone-delete'>Delete</a>" +				"</td>"+			"</tr>";		}				html += "</table>";		html += "<p>" +			"<a href='#' data-id='" + p.ID + "' class='icon add_icon telephone-add'>Add New Telephone</a> " +			"<a href='#' data-id='" + p.ID + "' class='icon refresh_icon telephones-refresh'>Refresh</a>" +			"</p>";			$('#telephones').html(html);	});}function render_person_form(person) {	var html = '';	if(person) {		html += "<h1>Edit Person</h1>";	}	else {		person = {			ID: '',			NAME: '',			FAM: '',			ADDRESS: ''		};		html += "<h2>Add Person</h2>";	}		html += "<form id='person-edit-form' action='#' method='post'>";	html += "<p><label>ID</label><input name='ID' class='txt medium' value='" + html_escape(person.ID) + "' readonly /></p>";	html += "<p><label>NAME</label><input name='NAME' class='txt medium' value='" + html_escape(person.NAME) + "'/></p>";	html += "<p><label>FAM</label><input name='FAM' class='txt medium' value='" + html_escape(person.FAM) + "'/></p>";	html += "<p><label>ADDRESS</label><input name='ADDRESS' class='txt medium' value='" + html_escape(person.ADDRESS) + "'/></p>";	html += "<p><button>Save</button></p>";	html += "</form>";		return html;}function render_telephone_form(telephone, teltypes) {	var html = '';	if(telephone) {		html += "<h1>Edit Telephone</h1>";	}	else {		telephone = {			ID: '',			NOMER: '',			TID: ''		};		html += "<h2>Add Telephone</h2>";	}			html += "<form id='telephone-edit-form' action='#' method='post'>";	html += "<p><label>ID</label><input name='ID' class='txt medium' value='" + html_escape(telephone.ID) + "' readonly /></p>";	html += "<p><label>NOMER</label><input name='NOMER' class='txt medium' value='" + html_escape(telephone.NOMER) + "'/></p>";		html += "<p><label>TEL TYPE</label><select name='TID' class='txt medium'>";	html += "<option value=''> </option>";	for(var i=0; i<teltypes.length; i++) {		var tt = teltypes[i];		var selected = (telephone.TID == tt.ID) ? 'selected' : '';		html += "<option value='" + tt.ID + "' " + selected + ">" + tt.TELTYPE + "</option>";	}	html += "</select></p>";	html += "<p><button>Save</button></p>";	html += "</form>";		return html;}function render_messages(messages) {	var html = '';	if(messages) {			for(var i = 0; i < messages.length; i++) {			var m = messages[i];			var css = (m.type === 'error') ? 'icon error_icon error' : 'icon info_icon info';			html += "<p class='" + css + "'>" + m.text + "</p>";		}	}	return html;}function html_escape(val) {		return (val+'')      .replace(/&/g, '&amp;')      .replace(/</g, '&lt;')      .replace(/>/g, '&gt;')      .replace(/\"/g, '&quot;')      .replace(/\'/g, '&apos;');}