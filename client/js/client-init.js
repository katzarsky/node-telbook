$(document).ready(function() {	var person_id = null;	var teltypes = null;	$.get('/teltypes', function(data) {		teltypes = data.teltypes;	});	render_persons(person_id);	// PERSONS	$(document).on('click', 'a.persons-refresh', function() {		render_persons(person_id);		return false;	});	$(document).on('click', 'a.person-add', function() {		$('#person-form').html(render_person_form(null));		$('#person-messages').html('');	});	$(document).on('click', 'a.person-edit', function() {		person_id = $(this).data('id');		$.get('/persons/' + person_id, function(data) {			$('#person-form').html(render_person_form(data.person));		});		$('#person-messages').html('');		render_persons(person_id);		return false;	});	$(document).on('submit', '#person-edit-form', function() {		var person = $(this).serializeObject();		$.postJSON('persons/' + person.ID, person, function(data) {			if(data.person) {				$('#person-form').html(render_person_form(data.person));			}			$('#person-messages').html(render_messages(data.messages));			render_persons(person_id);		});		return false;	});	$(document).on('click', 'a.person-delete', function() {		$.delete('/persons/' + $(this).data('id'), function(data) {			$('#person-form').html('');			$('#person-messages').html(render_messages(data.messages));			render_persons(person_id);		});		return false;	});	// TELEPHONES	$(document).on('click', 'a.person-telephones, a.telephones-refresh', function() {		person_id = $(this).data('id');		render_persons(person_id);		render_telephones(person_id);		$('#tel-details').html('');		return false;	});	$(document).on('click', 'a.telephone-delete', function() {		$.delete('/telephones/' + $(this).data('id'), function(data) {			$('#telephone-messages').html(render_messages(data.messages));			$('#telephone-details').html('');			render_telephones($('a.tels-refresh:first').data('id'));		});		return false;	});	$(document).on('click', 'a.telephone-edit', function(e) {		$.get('/telephones/' + $(this).data('id'), function(data) {			$('#telephone-messages').html('');			$('#telephone-form').html(render_telephone_form(data.telephone, teltypes));		});		return false;	});	$(document).on('click', 'a.telephone-add', function(e) {		var telephone = {			ID: 0,			PID: $(this).data('id'),			NOMER: '',			TID: ''		};		$('#telephone-form').html(render_telephone_form(telephone, teltypes));		$('#telephone-messages').html('');		return false;	});	$(document).on('submit', '#telephone-edit-form', function() {		var telephone = $(this).serializeObject();		$.postJSON('telephones/' + telephone.ID, telephone, function(data) {			if(data.telephone) {				$('#telephone-form').html(render_telephone_form(data.telephone, teltypes));				render_telephones(data.telephone.PID);			}			$('#telephone-messages').html(render_messages(data.messages));		});		return false;	});	});